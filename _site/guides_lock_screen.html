<!DOCTYPE html>
<html>
<head>
    <!-- the google_analytics_id gets auto inserted from the config file 



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','G-5LNVJND9XP','auto');ga('require','displayfeatures');ga('send','pageview');</script>


-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5LNVJND9XP"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-5LNVJND9XP');
</script>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Configuring Flutter Sound for background audio">
<meta name="keywords" content="guide,  lock_screen">
<title>Lock-screen | The Dank u Documentation</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-green.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="doc" href="/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>


            <a href="index.html"> <img src="images/tau/tau26.png" width="20%" height="20%" /> </a>
            <!--<img class="inline" src="images/tau7.svg" alt="tau" />
-->
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#" title="Show the left navigation bar"><i id="tg-sb-icon"
                            class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->

                
                

                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Run<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/toto" target="_blank" rel="noopener">τ-dio ex.</a></li>
                        
                        
                        
                        <li><a href="/titi" target="_blank" rel="noopener">Flutter Sound ex.</a></li>
                        
                        
                        
                        <li><a href="/titi" target="_blank" rel="noopener">τ ex.</a></li>
                        
                        
                        
                        <li><a href="/titi" target="_blank" rel="noopener">τ-graph engine</a></li>
                        
                        
                        
                        <li><a href="/titi" target="_blank" rel="noopener">τ-cpal ex.</a></li>
                        
                        
                        
                        <li><a href="/titi" target="_blank" rel="noopener">Run e-τ</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">News<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="news.html">News</a></li>
                        
                        
                        
                        <li><a href="https://github.com/canardoux/tau-doc/projects/1" target="_blank" rel="noopener">Roadmap</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Repo<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/canardoux/taudio" target="_blank" rel="noopener">τ-dio</a></li>
                        
                        
                        
                        <li><a href="https://github.com/canardoux/flutter_sound" target="_blank" rel="noopener">Flutter Sound</a></li>
                        
                        
                        
                        <li><a href="https://github.com/canardoux/taugraph" target="_blank" rel="noopener">τ-graph</a></li>
                        
                        
                        
                        <li><a href="https://github.com/canardoux/tau" target="_blank" rel="noopener">τ</a></li>
                        
                        
                        
                        <li><a href="https://github.com/canardoux/taucpal" target="_blank" rel="noopener">τ-cpal</a></li>
                        
                        
                        
                        <li><a href="https://github.com/canardoux/etau" target="_blank" rel="noopener">e-τ</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">pub.dev<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://pub.dev/packages/taudio" target="_blank" rel="noopener">τ-dio</a></li>
                        
                        
                        
                        <li><a href="https://pub.dev/packages/flutter_sound" target="_blank" rel="noopener">Flutter Sound</a></li>
                        
                        
                        
                        <li><a href="https://pub.dev/packages/tau" target="_blank" rel="noopener">τ</a></li>
                        
                        
                        
                        <li><a href="https://pub.dev/packages/taugraph" target="_blank" rel="noopener">τ-graph</a></li>
                        
                        
                        
                        <li><a href="https://pub.dev/packages/taucpal" target="_blank" rel="noopener">τ-cpal</a></li>
                        
                        
                        
                        <li><a href="https://pub.dev/packages/etau" target="_blank" rel="noopener">e-τ</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sharing<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://tau-t7l7803.slack.com" target="_blank" rel="noopener">Slack</a></li>
                        
                        
                        
                        <li><a href="https://app.element.io/#/room/#tau:matrix.org" target="_blank" rel="noopener">Element</a></li>
                        
                        
                        
                        <li><a href="https://discord.com/channels/799683099473870848/799683099473870852" target="_blank" rel="noopener">Discord</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">The τ family<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="td-README.html">τ-dio</a></li>
                        
                        
                        
                        <li><a href="fs-README.html">Flutter Sound</a></li>
                        
                        
                        
                        <li><a href="tau-README.html">τ</a></li>
                        
                        
                        
                        <li><a href="tgr-README.html">τ-graph</a></li>
                        
                        
                        
                        <li><a href="tau-README.html">τ-cpal</a></li>
                        
                        
                        
                        <li><a href="etau-README.html">e-τ</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:larpoux@canardoux.xyz?subject=The Dank u Documentation feedback&body=I have some feedback about the Lock-screen page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Lock-screen">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Dank u - 0.0.2</li>
  
  
  
      
  
  <li>
      <a title="Overview" href="#">Overview</a>
      <ul>
          
          
          
          <li><a title="Get started" href="index.html">Get started</a></li>
          
          
          
          
          
          
          <li><a title="Introduction" href="mydoc_introduction.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a title="Support" href="mydoc_support.html">Support</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Release Notes" href="#">Release Notes</a>
      <ul>
          
          
          
          <li><a title="6.0 Release notes" href="mydoc_release_notes_60.html">6.0 Release notes</a></li>
          
          
          
          
          
          
          <li><a title="5.0 Release notes" href="mydoc_release_notes_50.html">5.0 Release notes</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Links" href="#">Links</a>
      <ul>
          
          
          
          <li><a title="Migration" href="links_migration.html">Migration</a></li>
          
          
          
          
          
          
          <li><a title="Problem Report" href="https://github.com/Canardoux/tau/issues.html" target="_blank" rel="noopener">Problem Report</a></li>
          
          
          
          
          
          
          <li><a title="Roadmap" href="https://github.com/Canardoux/tau/projects/3.html" target="_blank" rel="noopener">Roadmap</a></li>
          
          
          
          
          
          
          <li><a title="Contributions" href="links_contribution.html">Contributions</a></li>
          
          
          
          
          
          
          <li><a title="License" href="links_license.html">License</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Admin" href="#">Admin</a>
      <ul>
          
          
          
          <li><a title="Commento" href="http://canardoux.xyz:8090/login" target="_blank" rel="noopener">Commento</a></li>
          
          
          
          
          
          
          <li><a title="Dank u Doc Stats" href="https://analytics.google.com/analytics/web/#/p276308667/reports/defaulthome" target="_blank" rel="noopener">Dank u Doc Stats</a></li>
          
          
          
          
          
          
          <li><a title="Teacher's stats" href="https://zozo.com" target="_blank" rel="noopener">Teacher's stats</a></li>
          
          
          
          
          
          
          <li><a title="Developer's stats" href="https://zazi.com" target="_blank" rel="noopener">Developer's stats</a></li>
          
          
          
          
          
          
          <li><a title="Dank u Web stats" href="https://momo.com" target="_blank" rel="noopener">Dank u Web stats</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Troubleshooting" href="#">Troubleshooting</a>
      <ul>
          
          
          
          <li><a title="Troubleshooting" href="mydoc_troubleshooting.html">Troubleshooting</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Tag archives" href="#">Tag archives</a>
      <ul>
          
          
          
          <li><a title="Tag archives overview" href="mydoc_tag_archives_overview.html">Tag archives overview</a></li>
          
          
          
          <li class="subfolders">
              <a title="Tag archive pages" href="#">Tag archive pages</a>
              <ul>
                  
                  
                  
                  <li><a title="Formatting pages" href="tag_formatting.html">Formatting pages</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Navigation pages" href="tag_navigation.html">Navigation pages</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Content types pages" href="tag_content_types.html">Content types pages</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Publishing pages" href="tag_publishing.html">Publishing pages</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Special layout pages" href="tag_special_layouts.html">Special layout pages</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Collaboration pages" href="tag_collaboration.html">Collaboration pages</a></li>
                  
                  
                  
                  
                  
                  <li><a title="Troubleshooting pages" href="tag_troubleshooting.html">Troubleshooting pages</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Lock-screen</h1>
</div>



<div class="post-content">

   
    <div class="summary">Configuring Flutter Sound for background audio</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

    <a target="_blank" rel="noopener" href="https://github.com/Canardoux/danku/tree/master/doc/en/pages/fs/guides/lock-screen.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    

   <h1 id="playing-background-audio">Playing background audio</h1>

<p>Flutter sounds open-architecture provides the ability to easily integrate a host of 3rd party plugins. We are strong advocates in keeping things simple (KISS) &amp; where a robust solution already exists, we would rather use that than trying to re-invent the wheel. With this in mind, we have provided an an example within our <code class="language-plaintext highlighter-rouge">demo app</code> that shows how to play background audio &amp; more importantly - how the audio can be controlled from your phones lock screen.</p>

<h2 id="setting-up-your-app-to-play-background-audio">Setting up your app to play background audio</h2>
<p>The first thing you will want to do is to amend your <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> file and include a reference to <code class="language-plaintext highlighter-rouge">audio service</code> :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>audio_service: ^0.18.3
</code></pre></div></div>

<h3 id="ios---amend-infoplist">iOS - Amend info.plist</h3>
<p>Next you will need to make some adjustments to your info.plist so that it supports <strong>background mode</strong> :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;key&gt;UIBackgroundModes&lt;/key&gt;
  &lt;array&gt;
    &lt;string&gt;audio&lt;/string&gt;
  &lt;/array&gt;
</code></pre></div></div>

<h3 id="android---amend-androidmanifestxml">Android - Amend AndroidManifest.xml</h3>
<p>For Android to work correctly - a number of important changes needs to be made in your <strong>AndroidManifest</strong> file (Note , the info below assumes your Android project is 1.12 , if your project is prior to that then you will need to update your project to follow the new Flutter Android project structure (https://github.com/flutter/flutter/wiki/Upgrading-pre-1.12-Android-projects)</p>

<h5 id="add-permissions">Add permissions</h5>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;uses-permission android:name="android.permission.WAKE_LOCK"/&gt;
 &lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE"/&gt;
</code></pre></div></div>
<h5 id="change-activity-name">Change Activity name</h5>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code> android:name="com.ryanheise.audioservice.AudioServiceActivity"
</code></pre></div></div>

<h5 id="add-the-audio-service--receiver-intents">Add the audio service &amp; receiver intents</h5>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;service android:name="com.ryanheise.audioservice.AudioService"&gt;
  &lt;intent-filter&gt;
    &lt;action android:name="android.media.browse.MediaBrowserService" /&gt;
  &lt;/intent-filter&gt;
&lt;/service&gt;
&lt;receiver android:name="com.ryanheise.audioservice.MediaButtonReceiver" &gt;
  &lt;intent-filter&gt;
    &lt;action android:name="android.intent.action.MEDIA_BUTTON" /&gt;
  &lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre></div></div>

<p><strong>A completed AndroidManifest would look something like this</strong></p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;manifest xmlns:tools="http://schemas.android.com/tools" ...&gt;
  &lt;uses-permission android:name="android.permission.WAKE_LOCK"/&gt;
  &lt;uses-permission android:name="android.permission.FOREGROUND_SERVICE"/&gt;
  
  &lt;application ...&gt;
    &lt;activity android:name="com.ryanheise.audioservice.AudioServiceActivity" ...&gt;
      ...
    &lt;/activity&gt;
    &lt;service android:name="com.ryanheise.audioservice.AudioService"
        android:exported="true" tools:ignore="Instantiatable"&gt;
      &lt;intent-filter&gt;
        &lt;action android:name="android.media.browse.MediaBrowserService" /&gt;
      &lt;/intent-filter&gt;
    &lt;/service&gt;
    &lt;receiver android:name="com.ryanheise.audioservice.MediaButtonReceiver"
        android:exported="true" tools:ignore="Instantiatable"&gt;
      &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.MEDIA_BUTTON" /&gt;
      &lt;/intent-filter&gt;
    &lt;/receiver&gt; 
  &lt;/application&gt;
&lt;/manifest&gt;
</code></pre></div></div>

<h2 id="provide-callbacks-from-the-lock-screen-to-your-audio-handler">Provide callbacks from the Lock Screen to your Audio Handler</h2>
<p>We need a way for our code to handle lock-screen audio callbacks (Play, Pause, Stop, Previous etc) - The way we do this is to initialise the <code class="language-plaintext highlighter-rouge">AudioService</code> and customize accordingly (Android is different to iOS), we also specify a plain vanila Dart class file that <strong>houses</strong> our callback code :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Future&lt;AudioHandler&gt; initAudioService() async {
  return await AudioService.init(
    builder: () =&gt; AudioPlayerHandler(),
    config: AudioServiceConfig(
      androidNotificationChannelId: 'com.fluttersound.audio',
      androidNotificationChannelName: 'Flutter Sound Audio Service Demo',

      /// The next two, specific to Android allows you to dismiss the Audio controls
      androidNotificationOngoing: true,
      androidStopForegroundOnPause: true,
    ),
  );
}
</code></pre></div></div>

<p>The configuration for your <code class="language-plaintext highlighter-rouge">AudioService</code> requires a completed <code class="language-plaintext highlighter-rouge">AudioServiceConfig</code>. This belongs to the <code class="language-plaintext highlighter-rouge">Audio Service Plugin</code> and allows you to easily and completely initialise iOS and Android :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AudioServiceConfig AudioServiceConfig({
  bool androidResumeOnClick = true,
  String? androidNotificationChannelId,
  String androidNotificationChannelName = 'Notifications',
  String? androidNotificationChannelDescription,
  Color? notificationColor,
  String androidNotificationIcon = 'mipmap/ic_launcher',
  bool androidShowNotificationBadge = false,
  bool androidNotificationClickStartsActivity = true,
  bool androidNotificationOngoing = false,
  bool androidStopForegroundOnPause = true,
  int? artDownscaleWidth,
  int? artDownscaleHeight,
  Duration fastForwardInterval = const Duration(seconds: 10),
  Duration rewindInterval = const Duration(seconds: 10),
  bool preloadArtwork = false,
  Map&lt;String, dynamic&gt;? androidBrowsableRootExtras,
})
package:audio_service/audio_service.dart

Creates a configuration object.
</code></pre></div></div>

<p>As you can see from the above snippet - you have full control for configuring Android.</p>

<p>We can see from the above <code class="language-plaintext highlighter-rouge">initAudioService</code> method that the audio handler is <code class="language-plaintext highlighter-rouge">AudioPlayerHandler</code>. This handler is what you will create and whereby you will ensure that it extends from <code class="language-plaintext highlighter-rouge">BaseAudioHandler</code>. This class is provided by the <code class="language-plaintext highlighter-rouge">AudioService</code> plugin - it will expect you to override base methods from this class so that you can control how your app behaves when control buttons like Pause, Play, Seek, Stop etc are triggered from your devices lock screen.</p>

<p>Ultimately you will simply override these base methods and delegate to your chosen AudioPlayer (Just Audio, Flutter Sound etc).</p>

<p>For the purpose of the demo, we have used JustAudio player within our <code class="language-plaintext highlighter-rouge">AudioPlayerHandler</code> but with some changes this could also be amended to include the callback code for Play, Stop, Seek, Pause etc for any Player (Flutter Sound etc).</p>

<p>With respect to <code class="language-plaintext highlighter-rouge">AudioPlayerHandler</code> - Here you will see how we override the base methods of <code class="language-plaintext highlighter-rouge">BaseAudioHandler</code> :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  @override
  Future&lt;void&gt; play() =&gt; _useFlutterSound
      ? _flutterSoundAudioPlayer.play()
      : _justAudioPlayer.play();

  @override
  Future&lt;void&gt; pause() =&gt; _useFlutterSound
      ? _flutterSoundAudioPlayer.pause()
      : _justAudioPlayer.pause();

  @override
  Future&lt;void&gt; seek(Duration position) =&gt; _useFlutterSound
      ? _flutterSoundAudioPlayer.seekTo(position)
      : _justAudioPlayer.seek(position);

  @override
  Future&lt;void&gt; stop() =&gt; _useFlutterSound
      ? _flutterSoundAudioPlayer.stop()
      : _justAudioPlayer.stop();

</code></pre></div></div>

<p>From the above code fragment - we use a simple switch <code class="language-plaintext highlighter-rouge">_useFlutterSound</code> to determine which player we wish to use and then delegate our callbacks accordingly.</p>

<h2 id="initialising-your-audio-service">Initialising your Audio Service</h2>

<p>You are free to choose how you want to initialise your audio service (Provider, Get_x etc)  but this should be one of the first things your app does. In our demo code, we have chosen to use a simple DI plugin <code class="language-plaintext highlighter-rouge">flutter_simple_dependency_injection</code> and we initialise this in <code class="language-plaintext highlighter-rouge">main()</code> as well as create our audio service :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Future&lt;void&gt; main() async {
  /// Lets add some DI to this demo !
  final injector = Injector();

  /// We want Audio template to be able to run in the background
  var audioService = await initAudioService();
  injector.map((i) =&gt; audioService, isSingleton: true);
  runApp(ExamplesApp());
}
</code></pre></div></div>

<p>This will then allow any code to reference <code class="language-plaintext highlighter-rouge">audioservice</code> easily :</p>

<p><strong>Play, Pause &amp; Stop buttons</strong></p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   
            StreamBuilder&lt;bool&gt;(
              stream: Injector()
                  .get&lt;AudioHandler&gt;()
                  .playbackState
                  .map((state) =&gt; state.playing)
                  .distinct(),
              builder: (context, snapshot) {
                final playing = snapshot.data ?? false;
                return Row(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    _button(Icons.fast_rewind,
                        Injector().get&lt;AudioHandler&gt;().rewind),
                    if (playing)
                      _button(Icons.pause, Injector().get&lt;AudioHandler&gt;().pause)
                    else
                      _button(Icons.play_arrow,
                          Injector().get&lt;AudioHandler&gt;().play),
                    _button(Icons.stop, Injector().get&lt;AudioHandler&gt;().stop),
                    _button(Icons.fast_forward,
                        Injector().get&lt;AudioHandler&gt;().fastForward),
                  ],
                );
              },
            ),
</code></pre></div></div>

<h2 id="summary">Summary</h2>

<p>Integrating <code class="language-plaintext highlighter-rouge">AudioService</code> into  Flutter Sound consists of :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1- Adding the plugin in your pubspec.yaml
2- Amending your AndroidManifest.xml
3- Amending your info.plist
4- Creating an AudioHandler that descends from BaseAudioHandler
5- Providing implementation code for Play, Pause, Seek, Stop etc
</code></pre></div></div>


    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        
        
    </div>


<script defer src="https://commento.canardoux.xyz/js/commento.js"></script>
<div id="commento"></div>
<noscript>Please enable JavaScript to load the comments.</noscript>



</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2024 Canardoux. All rights reserved. <br />
 Site last generated: Aug 8, 2024 <br />
<p><img src="images/danku32.png" alt="Danku"  max-width="10" width="20%" height="20%"/></p>/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>
</html>
